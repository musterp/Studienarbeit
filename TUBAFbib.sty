% TUBAFbib Bibliography fÃ¼r das Latex Corporate Design Projekt der TU Bergakademie Freiberg
% Copyright 2008 by Christian Degenkolb
% Copyright 2009-2014 by Christian Degenkolb, Thomas Benkert
% Copyright 2014-2019 by Thomas Benkert
% http://latex.tu-freiberg.de
% latex at tu bindestrich freiberg punkt de
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Dieses Werk ist unter einem Creative Commons 
% Namensnennung - Keine Bearbeitung 3.0 Deutschland Lizenzvertrag lizenziert. 
% Um die Lizenz anzusehen, gehen Sie bitte zu http://creativecommons.org/licenses/by-nd/3.0/de/ 
% oder schicken Sie einen Brief an 
% Creative Commons, 171 Second Street, Suite 300, San Francisco, California 94105, USA.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\TUBAFbib@name}{TUBAFbib}
\newcommand{\TUBAFbib@date}{2019/04/01}
\newcommand{\TUBAFbib@version}{v.2.5.1}

\ProvidesPackage{\TUBAFbib@name}[\TUBAFbib@date\space \TUBAFbib@version\space Christian Degenkolb, Thomas Benkert]
%
\typeout{Package \TUBAFbib@name\space \TUBAFbib@date\space \TUBAFbib@version\space Christian Degenkolb, Thomas Benkert^^J
	\@spaces\@spaces\@spaces\@spaces Biblographie-Stile fuer das TUBAF-CD^^J
	}
	%\@spaces\@spaces\@spaces\@spaces benoetigt mind. biblatex v.0.9 vom 2010/02/06}

%\PackageWarningNoLine{\TUBAFbib@name}{Die Stildatei '\TUBAFbib@name' wird nicht mehr unterstuetzt\MessageBreak und kann in Zukunft geloescht sein.\MessageBreak Nutzen Sie stattdessen direkt 'biblatex.sty'}
\PackageWarningNoLine{\TUBAFbib@name}{Die Stildatei '\TUBAFbib@name' kann in Zukunft geloescht sein.\MessageBreak Nutzen Sie stattdessen direkt 'biblatex.sty'}

\RequirePackage{xkeyval}
\RequirePackage{ifthen}
%csquotes wird nach Optionen geladen	% TB neu

\newcommand{\TUBAFbibstyle}{}
\newcommand{\TUBAFauthorstil}{}
\newcommand{\TUBAFreihenfolge}{}
\newboolean{nat}\setboolean{nat}{false}
\newcommand{\TUBAFbib@csquotes}{}	% TB neu
\newcommand{\TUBAFbib@backend}{}	% TB neu

\def\UrlBreaks{\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,\do\?\do\'\do\+\do\=\do\#\do\-}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Optionen
\DeclareOptionX{csquotes}{\renewcommand\TUBAFbib@csquotes{#1}}	% TB
%
\DeclareOptionX{backend}{\renewcommand\TUBAFbib@backend{#1}}	% TB
%
\DeclareOptionX{zitatstil}[unsorted]{%
	\XKV@cc*+[\val\nr]{#1}{chron,num,alph,nat,eco}{%
	\ifcase\nr\relax
		\renewcommand{\TUBAFbibstyle}{chron}
	   \or
		\renewcommand{\TUBAFbibstyle}{num}
	   \or
		\renewcommand{\TUBAFbibstyle}{alph}
	   \or
		\renewcommand{\TUBAFbibstyle}{nat}
	   \or
		\renewcommand{\TUBAFbibstyle}{eco}
	\fi    
	}{\PackageWarningNoLine{\TUBAFbib@name}{the input '\val' is incorrect and ignored}}%
}
%
\DeclareOptionX{autor}[normal]{%
	\XKV@cc*+[\val\nr]{#1}{normal,textsc}{%
	\ifcase\nr\relax
		\renewcommand{\TUBAFauthorstil}{normal}
	   \or
		\renewcommand{\TUBAFauthorstil}{textsc}
	\fi    
	}{\PackageWarningNoLine{\TUBAFbib@name}{the input '\val' is incorrect and ignored}}%
}
%
\DeclareOptionX{reihenfolge}[normal]{%
	\XKV@cc*+[\val\nr]{#1}{normal,ajt}{%
	\ifcase\nr\relax
		\renewcommand{\TUBAFreihenfolge}{normal}
	   \or
		\renewcommand{\TUBAFreihenfolge}{ajt}
	\fi    
	}{\PackageWarningNoLine{\TUBAFbib@name}{the input '\val' is incorrect and ignored}}%
}
%
\DeclareOptionX*{\PackageWarningNoLine{\TUBAFbib@name}{Unknown option ignored: \CurrentOption}}
%
\ExecuteOptionsX{%
	zitatstil=num,
	backend=bibtex
	}
%
\ProcessOptionsX\relax
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\RequirePackage[\TUBAFbib@csquotes]{csquotes}[2010/02/06]	% TB


\ifthenelse{\equal{\TUBAFbibstyle}{chron}}{%
	\RequirePackage[style=numeric-comp,sorting=none,backend=\TUBAFbib@backend]{biblatex}}{%
	\ifthenelse{\equal{\TUBAFbibstyle}{num}}{%
		\RequirePackage[style=numeric-comp,sorting=nty,backend=\TUBAFbib@backend]{biblatex}%
		}{%
		\ifthenelse{\equal{\TUBAFbibstyle}{alph}}{%
			\RequirePackage[style=alphabetic,sorting=nty,backend=\TUBAFbib@backend]{biblatex}%
		}{%
			\ifthenelse{\equal{\TUBAFbibstyle}{nat}}{%
				\setboolean{nat}{true}
				\RequirePackage[style=authoryear,sorting=nty,backend=\TUBAFbib@backend]{biblatex}%
% 				 %\RequireBibliographyStyle{standard}
% 				\RequireBibliographyStyle{authoryear}
% 				\ExecuteBibliographyOptions{labelyear,sorting=nyt,pagetracker,labelyear}

				\renewbibmacro*{date+extrayear}{%
				  \iffieldundef{year}
				    {}
				    {\printtext[parens]{%
				      \printfield{labelyear}}:%
				      }
				}
				\renewbibmacro*{cite:labelyear+extrayear}{%
				  \iffieldundef{labelyear}
				    {}
				    {\printtext[bibhyperref]{%
				      \printtext[parens]{%
				      \printfield{labelyear}}%
				      \printfield{extradate}}}%
				}
				\renewbibmacro*{textcite}{%
				  \ifnameundef{labelname}
				    {\iffieldundef{shorthand}
				      {\usebibmacro{cite:label}%
 					\setunit{%
 					  %\global\booltrue{cbx:parens}%
 					  \addspace}%\bibleftparen}%
					\usebibmacro{cite:labelyear+extrayear}}
				      {\usebibmacro{cite:shorthand}}}
				    {\printnames{labelname}%
 				    \setunit{%
 				      %\global\booltrue{cbx:parens}%
 				      \addspace}%\bibleftparen}%
				    \iffieldundef{shorthand}
				      {\iffieldundef{labelyear}
					  {\usebibmacro{cite:label}}
					  {\usebibmacro{cite:labelyear+extrayear}}}
				      {\usebibmacro{cite:shorthand}}}}
				\ifthenelse{\equal{\TUBAFauthorstil}{textsc}}{%
					\renewbibmacro*{author}{%
						\ifthenelse{\ifuseauthor\AND\NOT\ifnameundef{author}}
						{\ifthenelse{\iffieldequals{namehash}{\bbx@lasthash}\AND
								\NOT\iffirstonpage}
						{\bibnamedash}
						{\savefield{namehash}{\bbx@lasthash}%
							\textsc{\printnames{author}}%
							\iffieldundef{authortype}
							{\setunit{\addspace}}
							{\setunit{\addcomma\space}}}%
						\iffieldundef{authortype}
						{}
						{\usebibmacro{authorstrg}%
							\setunit{\addspace}}}%
						{\global\undef\bbx@lasthash
						\usebibmacro{labeltitle}%
						\setunit*{\addspace}}%
						\usebibmacro{date+extrayear}%
					}%
					\renewbibmacro*{cite}{%
						\iffieldundef{shorthand}
						{\ifthenelse{\ifnameundef{labelname}\OR\iffieldundef{year}}
						{\usebibmacro{cite:label}%
							\setunit{\addspace}}
						{\textsc{\printnames{labelname}}%
							\setunit{\nameyeardelim}}%
						\usebibmacro{cite:labelyear+extrayear}}
						{\usebibmacro{cite:shorthand}}
					}%
					\renewbibmacro*{textcite}{%
						\ifnameundef{labelname}{%
							\iffieldundef{shorthand}{%
								\usebibmacro{cite:label}%
								\setunit{\addspace%
								%\global\booltrue{cbx:parens}%
								%\addspace\bibleftparen
								}%
								\usebibmacro{cite:labelyear+extrayear}}%
							{%
								\usebibmacro{cite:shorthand}%
							}%
						}%
						{%
							\textsc{\printnames{labelname}}%
							\setunit{\addspace%
							%\global\booltrue{cbx:parens}%
							%\addspace\bibleftparen
							}%
							\iffieldundef{shorthand}{%
								\iffieldundef{year}%
								{\usebibmacro{cite:label}}%
								{\usebibmacro{cite:labelyear+extrayear}}}%
							{%
								\usebibmacro{cite:shorthand}%
							}%
						}%
					}%
				}%
			}{%
				\ifthenelse{\equal{\TUBAFbibstyle}{eco}}{%
					\RequirePackage[style=authortitle-comp,sorting=nty,backend=\TUBAFbib@backend]{biblatex}%
				}%
			}%
		}%
	}%
}%


%annika-article-volum-number-no-space-bug-fix
\renewbibmacro*{journal+issuetitle}{%
	\usebibmacro{journal}%
	\setunit*{\addspace}%
	\iffieldundef{series}
	  {}
	  {\newunit
	  \printfield{series}%
	  \setunit{\addspace}}%
	\printfield{volume}%
	\setunit*{\adddot\space}%
	\printfield{number}%
	\setunit{\addcomma\space}%
	\printfield{eid}%
	\setunit{\addspace}%
	\usebibmacro{issue+date}%
	\newunit\newblock
	\usebibmacro{issue}%
	\newunit}


\ifthenelse{\equal{\TUBAFreihenfolge}{ajt}}{%
	\ifthenelse{\boolean{nat}}{}{%
		\DeclareBibliographyDriver{book}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{maintitle+title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{edition}%
			\newunit
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}%
		}%
		\DeclareBibliographyDriver{article}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{version}%
			\newunit\newblock
			\usebibmacro{in:}%
			\usebibmacro{journal+issuetitle}%
			\newunit\newblock
			\printfield{note}%
			\setunit{\bibpagespunct}%
			\printfield{pages}
			\newunit\newblock
			\printfield{issn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
		\DeclareBibliographyDriver{booklet}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{howpublished}%
			\newunit\newblock
			\printfield{type}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
		
		\DeclareBibliographyDriver{collection}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{maintitle+title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{edition}%
			\newunit
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{inbook}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{in:}%
			\usebibmacro{bybookauthor}%
			\newunit\newblock
			\usebibmacro{maintitle+booktitle}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{edition}%
			\newunit
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{incollection}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{in:}%
			\usebibmacro{maintitle+booktitle}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\printfield{edition}%
			\newunit
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{inproceedings}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{in:}%
			\usebibmacro{maintitle+booktitle}%
			\newunit
			\printfield{venue}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\printlist{organization}%
			\newunit
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{manual}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor}%
			\newunit\newblock
			\printfield{edition}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{type}%
			\newunit
			\printfield{version}%
			\newunit
			\printfield{note}%
			\newunit\newblock
			\printlist{organization}%
			\newunit
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}
	
		\DeclareBibliographyDriver{misc}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor}%
			\newunit\newblock
			\printfield{howpublished}%
			\newunit\newblock
			\printfield{type}%
			\newunit
			\printfield{version}%
			\newunit
			\printfield{note}%
			\newunit\newblock
			\printlist{organization}%
			\newunit\newblock
			\printlist{location}%
			\newunit\newblock
			\usebibmacro{date}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{online}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author/editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\usebibmacro{byeditor}%
			\newunit\newblock
			\printfield{version}%
			\newunit
			\printfield{note}%
			\newunit\newblock
			\printlist{organization}%
			\newunit\newblock
			\usebibmacro{date}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
	
		\DeclareBibliographyDriver{patent}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\printfield{type}%
			\setunit*{\addspace}%
			\printfield{number}%
			\iflistundef{location}
			{}
			{\setunit*{\addspace}%
			\printtext[parens]{%
			\printlist[][-\value{listtotal}]{location}}}%
			\newunit\newblock
			\usebibmacro{byholder}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{date}%
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}
	
		\DeclareBibliographyDriver{periodical}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title+issuetitle}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byeditor}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\printfield{issn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}
		\DeclareBibliographyDriver{proceedings}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{editor}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{maintitle+title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\printfield{venue}%
			\newunit\newblock
			\usebibmacro{byeditor+others}%
			\newunit\newblock
			\iffieldundef{maintitle}
			{\printfield{volume}%
			\printfield{part}}
			{}%
			\newunit
			\printfield{volumes}%
			\newunit\newblock
			\usebibmacro{series+number}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\printlist{organization}%
			\newunit
			\usebibmacro{publisher+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{isbn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
		\DeclareBibliographyDriver{report}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\printfield{type}%
			\setunit*{\addspace}%
			\printfield{number}%
			\newunit\newblock
			\printfield{version}%
			\newunit
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{institution+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{isrn}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
		\DeclareBibliographyDriver{thesis}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\printfield{type}%
			\newunit
			\usebibmacro{institution+location+date}%
			\newunit\newblock
			\usebibmacro{chapter+pages}%
			\newunit
			\printfield{pagetotal}%
			\newunit\newblock
			\printfield{doi}%
			\newunit\newblock
			\usebibmacro{eprint}
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}
		\DeclareBibliographyDriver{unpublished}{%
			\usebibmacro{bibindex}%
			\usebibmacro{begentry}%
			\usebibmacro{author}%
			\newunit\newblock
			\setunit*{}
			(\printfield{year})%
			\setunit{:}\newblock
			\usebibmacro{title}%
			\newunit
			\printlist{language}%
			\newunit\newblock
			\usebibmacro{byauthor}%
			\newunit\newblock
			\printfield{howpublished}%
			\newunit\newblock
			\printfield{note}%
			\newunit\newblock
			\usebibmacro{date}%
			\newunit\newblock
			\usebibmacro{url+urldate}%
			\newunit\newblock
			\printfield{addendum}%
			\newunit\newblock
			\usebibmacro{pageref}%
			\usebibmacro{finentry}
		}%
		\renewbibmacro*{issue+date}{%
			\printtext[parens]{%
			\iffieldundef{issue}
			{\iffieldundef{month}
				{\printfield{year}}
				{\iffieldundef{day}
				{\printfield{month}%
				\setunit{\addspace}%
				\printfield{year}}
				{\printtext{\bibdate}}}}
			{\printfield{issue}%
			\setunit{\addspace}%
			\printfield{year}}}%
			\newunit
		}%
	}%
}%

\setlength{\bibhang}{1em}

% TB
\ifthenelse{\boolean{nat}}{%
	\ExecuteBibliographyOptions{%
		hyperref=auto,
		sortcites=true,%
		maxnames=3,%
		minnames=2%
	}%
   }{%
	\ExecuteBibliographyOptions{%
		hyperref=auto,
		sortcites=true,%
		maxnames=8,%
		minnames=8%
	}%
}
%
% Sortierreihenfolge Nachname, Vorname
\@ifpackagelater{biblatex}{2016/03/01}{% Test auf Version 3.3 und Anpassung der Namensformatierung
	%% TB neu
	%% TB nach https://www.texdev.net/2016/03/13/biblatex-a-new-syntax-for-declarenameformat/
	%% TB Zahlen-Befehls-Zuordnung: https://tex.stackexchange.com/questions/299036/biblatex-3-3-name-formatting
	%% TB	#1->\namepartfamily, #2->\namepartfamilyi
	%% TB	#3->\namepartgiven,  #4->\namepartgiveni
	%% TB	#5->\namepartprefix, #6->\namepartprefixi
	%% TB	#7->\namepartsuffix, #8->\namepartsuffixi
	\DeclareNameFormat{default}{%
		\renewcommand*{\multinamedelim}{\addsemicolon\addspace}%
		\nameparts{#1}%
	  \ifgiveninits
	    {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiveni}{\namepartprefix}{\namepartsuffix}}%
	    {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiven}{\namepartprefix}{\namepartsuffix}}%
	  \usebibmacro{name:andothers}}
	\DeclareNameFormat{sortname}{%
	  \ifnum\value{listcount}=1\relax
	    \ifgiveninits
	      {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiveni}{\namepartprefix}{\namepartsuffix}}%
	      {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiven}{\namepartprefix}{\namepartsuffix}}%
	    \ifblank{\namepartfamilyi\namepartgiven}
	      {}
	      {\usebibmacro{name:revsdelim}}%
	  \else
	    \ifgiveninits
	      {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiveni}{\namepartprefix}{\namepartsuffix}}%
	      {\usebibmacro{name:family-given}{\namepartfamily}{\namepartgiven}{\namepartprefix}{\namepartsuffix}}%
	  \fi
	  \usebibmacro{name:andothers}}
    }{%
	\DeclareNameFormat{default}{%
	  \iffirstinits
	    {\usebibmacro{name:last-first}{#1}{#4}{#5}{#7}}
	    {\usebibmacro{name:last-first}{#1}{#3}{#5}{#7}}%
	  \usebibmacro{name:andothers}}
	\DeclareNameFormat{sortname}{%
	  \ifnum\value{listcount}=1\relax
	    \iffirstinits
	      {\usebibmacro{name:last-first}{#1}{#4}{#5}{#7}}
	      {\usebibmacro{name:last-first}{#1}{#3}{#5}{#7}}%
	    \ifblank{#3#5}
	      {}
	      {\usebibmacro{name:revsdelim}}%
	  \else
	    \iffirstinits
	      {\usebibmacro{name:last-first}{#1}{#4}{#5}{#7}}
	      {\usebibmacro{name:last-first}{#1}{#3}{#5}{#7}}%
	  \fi
	  \usebibmacro{name:andothers}}
}
% TB Ende
% Optionen: 
% unsorted (vorn Zahl, LV: Zahl, LV chronologisch), 
% numeric (vorn Zahl, LV Zahl, LV alphabetisch), 
% alph (vorn drei Buchstaben+Jahreszahl [WER98], LV ebenso + alphabetisch sort.), 
% author-year (vorn Werner (1998), LV alphabetisch sort.), 
% eco (vorn Autor, Jahr + Kurztitel, LV alphabetisch)

\endinput
